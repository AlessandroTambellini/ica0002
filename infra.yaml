---
- name: Initial setup
  hosts: all
  roles:
    - init
  tags: init

- name: DNS servers
  hosts: dns_servers
  roles:
    - bind
  tags: dns

- name: Resolvers
  hosts: all
  roles:
    - resolvers
  tags: dns

- name: Prometheus server
  hosts: prometheus_servers
  roles:
    - prometheus
    - nginx
  tags: p

- name: Grafana server
  hosts: grafana_servers
  roles:
    - grafana
  tags: g

- name: Database server
  hosts: db_servers
  roles:
    - mysql
  tags: db

- name: Web servers
  hosts: web_servers
  roles:
    - agama
    - uwsgi
    - nginx
  tags: ws

- name: InfluxDB
  hosts: influxdb_servers # execute as root user
  roles:
    - influxdb
  tags: i

- name: pinger
  hosts: pinger_servers
  roles:
    - pinger
  tags: pg
