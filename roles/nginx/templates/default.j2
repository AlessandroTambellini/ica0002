server {
listen 80 default_server;
server_name _;

{% if 'web_servers' in group_names %}
location / {
uwsgi_pass localhost:5000;
include uwsgi_params;
}
{% endif %}

{% if 'prometheus_server' in group_names %}
location /prometheus {
proxy_pass http://localhost:9090;
}

location /grafana {
proxy_set_header Host $http_host;
proxy_pass http://localhost:3000;
}
{% endif %}

}

server {
listen 8080 default_server; {# 8080 is commonly used for web server communications #}

location = /stub_status {
stub_status;
}
}